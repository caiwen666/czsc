# 语法扫尾

我们在前三节课讲述了 C++ 语法方面的三个主要结构：顺序结构、分支结构、循环结构。我们这节课再继续补充一些关键的语法。

## 1 逻辑表达式与布尔类型

我们在之前讲到“条件”这个东西，用于 `if`、`while`、`for` 语句。表示条件的时候我们引入了 `==`、`!=`、`>=`、`||`、`!` ... 等一系列的符号。实际上这些符号也是运算符，只不过他们不是像 `+`、`-` 这样的**算术运算符**，而是**逻辑运算符**。逻辑运算符构成了我们之前所说的“条件”，更正式的说法是**逻辑表达式**。逻辑表达式的运算结果不是数字，而是**布尔值**。布尔值只有两种取值，要么为 `true`，要么为 `false`。一个逻辑表达式如果成立，那么其运算结果为 `true`，反之为 `false`。如 `if(a+b==c)` 也可以更详细地看成 `if((a+b==c)==true)`。

对于 `!=`、`==`、`>`、`>=`、`<`、`<=` 这些运算符，运算结果为布尔值。 `||`、`&&` 运算则作用在两个布尔值上（我们之前说这两个符号连接两个条件，现在我们直到所谓的“条件”其实是一个运算结果为布尔值的逻辑表达式），有运算表：

|a|b|`a||b`|
|-|-|-|
|false|false|false|
|false|true|true|
|true|false|true|
|true|true|true|

|a|b|`a&&b`|
|-|-|-|
|false|false|false|
|false|true|false|
|true|false|false|
|true|true|true|

我们以前看到的运算符都是写在中间，运算符左右两边写这个运算符要作用的值，我们把这种运算符叫做**双目运算符**。有一种特殊运算符，如 `!`，我们之前管他叫“取反”，用法为 `!` 后面跟上一个条件。现在我们从逻辑运算的角度看他，有运算表：

|a|`!a`|
|-|-|
|true|false|
|false|true|

我们发现这个运算符只作用在一个值身上，我们把这种运算符叫做**单目运算符**。

我们说 C++ 中所有的数据都有类型。布尔值对应的类型为**布尔类型**，用 `bool` 表示。`true` 和 `false` 就是布尔类型的字面量，且布尔类型也只有这两种字面量。比如我们可以有 `bool flag=true;`。

于是我们就可以从新的角度看待之前的 if 语句。`if(条件)` 更正式的说法为 `if(布尔值)`，如果布尔值为 `true` 就执行其后跟着的花括号内的代码，如：

```cpp
bool flag1 = a < b;
bool flag2 = b < c;
if(flag1){
    ...
}
if(!flag2){
    ...
}
if(flag1 && flag2){
    ...
}
```

## 2 函数

我们在数学中学过函数，C++ 中也有“函数”这个东西，我们可以类比一下：数学中的函数可能有零个，一个或多个自变量，然后有一个因变量，因变量随着自变量的变化而变化。C++ 中的函数，把数学中函数的自变量称为**参数**，把因变量称为函数的**返回值**。更通俗的讲，我们向一个函数提供其所需的参数，这个函数就能根据给定参数输出一个结果。

定义函数的语法为：

`返回值数据类型 函数名(参数){}`

一般我们把函数定义在 `int main() { ` 的前面，也就是之前用于定义全局变量的位置。

现在我们可以来解释一下我们之前从未解释的一行代码：`int main() { `。我们发现这行代码遵循了上述函数定义的语法：我们定义了一个函数，名字叫 `main`，函数的返回值类型为 int 类型。C++ 中规定，所有程序都必须定义一个 `main` 函数，`main` 函数是程序的入口。当程序运行时，我们的电脑会自动**调用** `main` 函数。调用函数的意思是：先暂停执行当前的代码，转而去执行被调用的函数的花括号内的代码，直到函数**返回**，再接着从刚才暂停的地方继续执行。这也就解释了为什么我们要求程序的代码要写在 `main` 函数后面的花括号里面。

我们自己也可以在代码中定义一个函数，然后去调用它。显然，一个函数需要事先被定义后才能调用。

调用函数的语法是：

`函数名(参数);`

函数在执行完毕之后可以返回一个值，这个值称为函数的返回值。相关语法为：

`return 值;`

一旦 return 了，整个函数就结束了，代码不再继续往下执行。main 函数的结束就意味着整个程序的结束。这也就是为什么上一节课我们说 `return 0;` 就可以结束这个程序，因为我们把 main 函数返回了。如果你在别的函数里写 `return 0;`，那么程序并不会结束。而我们又有规定：main 函数的返回值必须是 int 类型，且必须返回 0。如果返回别的数字，在正式比赛时你的程序会直接判为 0 分！这也就解释了为什么 main 函数最后都要有一个 `return 0;`。

有时候一个函数可能只希望进行一些操作，而无需返回值。这种情况下我们就可以在函数返回值类型那里写 `void` 表示函数没有返回值。没有返回值的函数也可以使用 return 语句，此时直接写 `return;` 就可以了。我们在无返回值的函数中写 return 语句一般是希望提前结束函数的执行。

到这里我们可以举一个例子：

```cpp
#include<bits/stdc++.h>
using namespace std;

void print(){
	cout << "hello" << endl;
	return;
	cout << "world" << endl;
}

int main() { 
	cout << "begin" << endl;
	print();
	cout << "endl" << endl;
	return 0;
}
```

输出结果为 

```
begin
hello
endl
```

我们可以看到，调用 print 函数后，main 函数会暂停执行，等待 print 函数执行完毕。print 函数执行时，会执行其花括号内的代码，输出了 `hello`，而后由于 `return;`，print 函数返回，函数执行结束。print 函数结束后，就又回到了 main 函数，从之前 main 函数暂停的位置继续往下执行，输出 `end`。

如果函数有返回值，那么我们可以在函数调用结束之后拿到这个返回值并使用，如：

```cpp
#include<bits/stdc++.h>
using namespace std;

int print(){
	cout << "hello" << endl;
	return 123;
	cout << "world" << endl;
}

int main() { 
	cout << "begin" << endl;
	cout << print() + 1 << endl;
	cout << "endl" << endl;
	return 0;
}
```

输出结果为 

```
begin
hello
124
endl
```

不过目前这个样子很没意思，因为我们的函数的返回值是固定的。如果我们希望函数根据具体情况返回相应的数据，我们就需要给函数传递**参数**。

定义函数时，我们在圆括号里写函数参数。格式为 `数据类型 参数名1, 数据类型 参数名2,...`。格式很类似定义变量的格式，但是不同的是，每个参数名都需要写上其数据类型。这就表示当前函数需要的参数。函数的参数可以像变量一样在函数内使用，也就是参数的作用域为函数内部。如：

```cpp
int print(int x){
	cout << "hello" << x << endl;
	return x + 1;
}
```

我们在调用函数的时候需要传递参数。传递的内容写在调用函数时的圆括号里面，用逗号分开。传递的参数值的数量必须和函数定义时要求的参数数量保持一致，且数据类型必须一一对应。如：

```cpp
cout << "begin" << endl;
cout << print(123) + 1 << endl;
cout << "endl" << endl;
```

输出为 

```
begin
hello123
125
endl
```

比如我们可以写一个取两个数字之间最小值的函数，代码如下：

```cpp
#include<bits/stdc++.h>
using namespace std;

int my_min(int a,int b){
	if(a<=b){
		return a;
	}else{
		return b;
	}
}

int main() { 
	cout << my_min(10,9);
    // 输出 9
	return 0;
}
```

第二次课的题目选讲中我们讲了一道上取整的题目，我们可以把它封装成一个函数使用：

```cpp
int my_ceil(int a, int b){
	if (a % b == 0) {
    	return a / b;
	} else {
		return a / b + 1;
	}
}
```

假设，如果我们的代码中需要用到很多次上取整，如果不使用函数的话，那么我们就需要在 main 函数内写多次上取整的 if 语句，会让代码变得冗长。这也就体现了函数的一个作用：把需要多次使用的代码片段提取出来，封装成函数，使得代码更加整洁。

我们还可以把第三节课讲的质数判断封装成函数：

```cpp
bool is_prime(int x){
	bool res=true;
	for(int i=2;i<=x-1;i++){
		if(x%i==0){
			res=false;
			break;
		}
	}
	return res;
}
```

上述代码中，`is_prime` 函数可以判断参数 `x` 是否为质数，如果为质数就返回 `true`，反之返回 `false`。

一道题目，我们可能需要多个步骤才能解决。如果我们直接从整体上考虑，则不容易解决。有时候我们可以把一个大问题拆分成若干个小问题，然后逐个解决，这样会让我们的思考压力减小一点，此时函数就可以派上用场。比如一道题目，可能判断素数是中间的某个步骤，而对于初学者来说判断素数可能并非轻而易举，那么我们就可以先集中注意力思考如何实现判断素数，然后将其封装为一个函数，后续直接调用即可。这样的“模块化”不仅可以让我们更好地解决难题，还可以让代码变得更清晰，不容易出错。

一个好消息是，C++ 中自带了很多函数，使用这些函数可以帮助我们减少代码量：

* `max(a,b)`、`min(a,b)` 取 `a` 和 `b` 中最大值/最小值。注意 a 和 b 的数据类型要相同。

* `swap(a,b)`，`a` 和 `b` 必须是两个变量而不能是字面量。这个函数可以把两个变量的值进行交换。

* `ceil(x)`、`floor(x)`，`x` 必须是一个 double 类型的字面量或是变量。作用是将小数 `x` 上取整/下取整。

## 3 字符串

### 3.1 字符与 ASCII 码

我们再引入一个新的数据类型：字符类型，用 `char` 表示。如我们可以定义：`char ch;`。字符类型的字面量用单引号表示，单引号包裹一个字符，如 `ch='c'`、`ch=' '`、`ch=';'`，而不能是 `ch='ab'`。

在计算机中，字符和数字有一个一一对应的关系。这个对应关系就是 ASCII 码，如下：

![](https://pic.caiwen.work/i/2025/01/24/67934ec296150.png)

![](https://pic.caiwen.work/i/2025/01/24/67934ec219917.png)

我们主要关注表中“十进制”和“图形”这两列。这两列就表明了字符和数字的对应关系。

在 C++ 中，char 可以与 int 类型相互转换，转换的对应关系就根据 ASCII 码来，如：

```cpp
#include<bits/stdc++.h>
using namespace std;

int main() { 
	char ch_a = 'A';
	cout << (int)ch_a << ' ' << (char) 65;
	return 0; 
}
```

根据上表，字符 `'A'` 与 `65` 对应。代码中，我们把 `ch_a` 强制转换为 int 类型，输出为 65。将 int 类型的字面量 `65` 强制转换为 `char` 类型，输出为 `A`。

由于我们可以直接写代码来得到 ASCII 码表，因此上面这个表无需记忆。

我们再注意一点：数字字符的 ASCII 码是连续的，小写字母的ASCII码是连续的，大写字母的ASCII码也是连续的。

然后再说一点：char 类型也是可以进行运算的，运算的时候会以 ASCII 码的形式来参与运算，如：

```cpp
cout << (char)('A' + 1);
```

会输出 `B`。具体运算过程为：首先 `'A'` 自动变成其对应的 ASCII 码，即 `65`，`65 + 1` 为 `66`，然后再将其强制转为 char 类型，根据上表，`66` 对应的字符为 `B`。其实不用根据上表，因为我们说大写字母的 ASCII 码是连续的，所以 `'A' + 1` 就可以视为字母 `A` 的下一个字母，为 `B`。

### 3.2 字符串

把字符串在一起就得到了字符串。

我们再引入一个新的数据类型：字符串类型，用 `string` 表示。如我们可以定义 `string str;`。string 类型的字面量我们在第一节课就提到过，用双引号表示，双引号包裹字符串的内容，如 `str="hello";`。

string 类型有个特性：可以当数组来使用。比如 `str[0]` 就表示取出字符串第一个字符，其数据类型就为 char 类型。

string 类型还有个特殊用法。我们可以写 `str.size()` 来获取字符串 `str` 的长度。`size()` 是一个函数，只不过这个函数和我们之前所讲的有点不一样，需要用一个 `.` 来调用。

## 4 题目选讲

### 4.1 大小写字母转化

**题目描述**

大家都知道一些办公软件有自动将字母转换为大写的功能。输入一个长度不超过 $100$ 且不包括空格的字符串。要求将该字符串中的所有小写字母变成大写字母并输出。

**输入格式**

输入一行，一个字符串。

**输出格式**

输出一个字符串，即将原字符串中的所有小写字母转化为大写字母。

**输入 #1**

```
Luogu4!
```

**输出 #1**

```
LUOGU4!
```

核心问题是：如何判断一个字符是否是小写字母，以及如何把一个小写字母字符转换成大写字母字符。

对于前者，我们之前提到：小写字母的 ASCII 码是连续的，所以，我们可以判断一个字符的 ASCII 码是否位于 `'a'` 和 `'z'` 对应的 ASCII 码之间。当然，我们无需查阅上面的 ASCII 码表，因为我们又说，char 类型的运算都是转为 ASCII 码来进行的。因此，我们可以直接写 `x >= 'a' && x <= 'z'` 来判断。

对于后者，还是需要注意，小写字母的 ASCII 码是连续的，大写字母的 ASCII 码也是连续的。而且，大写字母之间和小写字母之间的相对位置应该是一样的，比如 `d` 在 ASCII 码上比 `a` 大 3，那么 `D` 在 ASCII 码上也比 `d` 大 3。这样，我们就可以有：`(char)(x-'a'+'A')` 来把小写字母字符 `x` 转为大写字母字符。

```cpp
#include<bits/stdc++.h>
using namespace std;

int main(){
	string str;
	cin>>str;
	for(int i=0;i<str.size();i++){
		if(str[i]>='a' && str[i]<='z'){
			cout<<(char)(str[i]-'a'+'A');
		}else{
			cout<<str[i];
		}
	}
	return 0;
} 
```

### 4.2 数字反转

**题目描述**

输入一个不小于 $100$ 且小于 $1000$，同时包括小数点后一位的一个浮点数，例如 $123.4$ ，要求把这个数字翻转过来，变成 $4.321$ 并输出。

**输入格式**

一行一个浮点数

**输出格式**

一行一个浮点数

**输入 #1**

```
123.4
```

**输出 #1**

```
4.321
```

一个思路是，沿用我们上节课讲的分隔数字的方法，反复取模，除法来切割一个数字。但是这道题目输入的是浮点数，之前的法子可能就不好使了。

首先考虑怎么去读入题目给出的数字。如果你选择使用 double 类型的变量读入的话，那么这道题目可能就做不出来了。我们转化下思维，考虑把题目给出的这个浮点数视为一个字符串，这样一来我们只需要解决把一个字符串反转的问题就可以了。方法也很简单，读入之后再倒着循环输出就好了。

```cpp
#include<bits/stdc++.h>
using namespace std;

int main(){
	string str;
	cin>>str;
	for(int i=str.size()-1;i>=0;i--){
		cout<<str[i];
	}
	return 0;
} 
```

## 5 自学内容

下面的部分请自行学习。这些内容